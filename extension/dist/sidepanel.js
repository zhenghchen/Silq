import{r as c,j as e,c as I}from"./client.js";const K=["openai","claude","gemini"],z=({savedKeys:a,activeProvider:p,onProviderChange:l})=>{const f=o=>{switch(o){case"openai":return"OpenAI";case"claude":return"Claude";case"gemini":return"Gemini";default:return o}},i=o=>a.some(d=>d.provider===o);return e.jsxs("div",{style:{marginBottom:"24px",padding:"16px",border:"1px solid #e5e7eb",borderRadius:"8px",backgroundColor:"#f9fafb"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Active AI Model"}),e.jsx("select",{value:p,onChange:o=>l(o.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",fontFamily:"inherit",backgroundColor:"#ffffff"},children:K.map(o=>{const d=i(o);return e.jsx("option",{value:o,disabled:!d,style:{color:d?"#374151":"#9ca3af"},children:d?f(o):`${f(o)} (No Key)`},o)})})]})},C=()=>{const[a,p]=c.useState([]),[l,f]=c.useState(""),[i,o]=c.useState("openai"),[d,y]=c.useState("openai"),[b,m]=c.useState(!0);c.useEffect(()=>{(async()=>{try{const t=await chrome.storage.local.get(["apiKeys","activeProvider"]);t.apiKeys&&p(t.apiKeys),t.activeProvider&&y(t.activeProvider)}catch(t){console.error("Error loading API keys:",t)}finally{m(!1)}})()},[]);const x=async()=>{if(!l.trim())return;const r={id:Date.now().toString(),provider:i,key:l.trim()},t=[...a,r];p(t),f(""),o("openai");try{await chrome.storage.local.set({apiKeys:t})}catch(s){console.error("Error saving API key:",s)}},u=async r=>{const t=a.filter(s=>s.id!==r);p(t);try{await chrome.storage.local.set({apiKeys:t})}catch(s){console.error("Error deleting API key:",s)}},v=async r=>{y(r);try{await chrome.storage.local.set({activeProvider:r})}catch(t){console.error("Error saving active provider:",t)}},S=r=>{switch(r){case"openai":return"OpenAI";case"claude":return"Claude";case"gemini":return"Gemini";default:return r}},w=r=>{switch(r){case"openai":return"O";case"claude":return"C";case"gemini":return"G";default:return"?"}},j=r=>{switch(r){case"openai":return"#10a37f";case"claude":return"#d97706";case"gemini":return"#3b82f6";default:return"#6b7280"}},k=r=>r.length<=8?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":`${r.substring(0,4)}â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢${r.substring(r.length-4)}`,n=({apiKey:r,onDelete:t})=>e.jsxs("div",{style:{padding:"16px",border:"1px solid #e5e7eb",borderRadius:"8px",backgroundColor:"#ffffff",display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"6px",backgroundColor:j(r.provider),display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:"600",color:"#ffffff"},children:w(r.provider)}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0",fontSize:"14px",fontWeight:"600",color:"#111827"},children:S(r.provider)}),e.jsx("p",{style:{margin:"0",fontSize:"12px",color:"#6b7280",fontFamily:"monospace"},children:k(r.key)})]})]}),e.jsx("button",{onClick:()=>t(r.id),style:{padding:"6px 12px",border:"1px solid #ef4444",borderRadius:"6px",backgroundColor:"#ffffff",color:"#ef4444",cursor:"pointer",fontSize:"12px",fontWeight:"500",transition:"all 0.2s ease"},onMouseOver:s=>{s.currentTarget.style.backgroundColor="#ef4444",s.currentTarget.style.color="#ffffff"},onMouseOut:s=>{s.currentTarget.style.backgroundColor="#ffffff",s.currentTarget.style.color="#ef4444"},children:"Delete"})]});return b?e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"200px"},children:e.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid #e5e7eb",borderTop:"2px solid #7c3aed",borderRadius:"50%",animation:"spin 1s linear infinite"}})}):e.jsxs("div",{children:[e.jsx("h2",{style:{margin:"0 0 24px 0",fontSize:"20px",fontWeight:"600",color:"#111827"},children:"API Key Management"}),e.jsx(z,{savedKeys:a,activeProvider:d,onProviderChange:v}),e.jsxs("div",{style:{marginBottom:"32px",padding:"20px",border:"1px solid #e5e7eb",borderRadius:"8px",backgroundColor:"#f9fafb"},children:[e.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"16px",fontWeight:"600",color:"#111827"},children:"Add New API Key"}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"flex-end"},children:[e.jsxs("div",{style:{flex:"0 0 120px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"12px",fontWeight:"500",color:"#374151"},children:"Provider"}),e.jsxs("select",{value:i,onChange:r=>o(r.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",fontFamily:"inherit",backgroundColor:"#ffffff"},children:[e.jsx("option",{value:"openai",children:"OpenAI"}),e.jsx("option",{value:"claude",children:"Claude"}),e.jsx("option",{value:"gemini",children:"Gemini"})]})]}),e.jsxs("div",{style:{flex:"1",minWidth:"0"},children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"12px",fontWeight:"500",color:"#374151"},children:"API Key"}),e.jsx("input",{type:"password",value:l,onChange:r=>f(r.target.value),placeholder:"Paste your API key here",style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",fontFamily:"inherit",backgroundColor:"#ffffff",boxSizing:"border-box"}})]}),e.jsx("button",{onClick:x,disabled:!l.trim(),style:{padding:"8px 16px",backgroundColor:l.trim()?"#7c3aed":"#f3f4f6",color:l.trim()?"#ffffff":"#9ca3af",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:"500",cursor:l.trim()?"pointer":"not-allowed",transition:"all 0.2s ease"},children:"Save Key"})]})]}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600",color:"#111827"},children:"API Keys"}),a.length===0?e.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#6b7280",backgroundColor:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:"8px"},children:e.jsx("p",{style:{margin:"0",fontSize:"14px"},children:"You have no saved API keys."})}):e.jsx("div",{children:a.map(r=>e.jsx(n,{apiKey:r,onDelete:u},r.id))})]}),e.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `})]})},R=()=>{const[a,p]=c.useState("api-keys"),l=[{id:"api-keys",label:"API Keys",icon:"ðŸ”‘"}],f=()=>{switch(a){case"api-keys":return e.jsx(C,{});default:return e.jsx(C,{})}};return e.jsxs("div",{style:{height:"100vh",display:"flex",backgroundColor:"#ffffff",color:"#1f2937",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans", Helvetica, Arial, sans-serif',fontSize:"14px",lineHeight:"1.5"},children:[e.jsxs("div",{style:{width:"220px",flexShrink:0,borderRight:"1px solid #e0e0e0",backgroundColor:"#f9fafb",display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{padding:"16px",borderBottom:"1px solid #e5e7eb",backgroundColor:"#ffffff"},children:e.jsx("h1",{style:{margin:"0",fontSize:"16px",fontWeight:"600",color:"#111827"},children:"Settings"})}),e.jsx("nav",{style:{padding:"8px",flex:"1"},children:l.map(i=>e.jsxs("button",{onClick:()=>p(i.id),style:{width:"100%",padding:"12px 16px",marginBottom:"4px",border:"none",borderRadius:"8px",backgroundColor:a===i.id?"#7c3aed":"transparent",color:a===i.id?"#ffffff":"#374151",fontSize:"14px",fontWeight:a===i.id?"500":"400",cursor:"pointer",display:"flex",alignItems:"center",gap:"12px",transition:"all 0.2s ease",textAlign:"left"},onMouseOver:o=>{a!==i.id&&(o.currentTarget.style.backgroundColor="#f3f4f6")},onMouseOut:o=>{a!==i.id&&(o.currentTarget.style.backgroundColor="transparent")},children:[e.jsx("span",{style:{fontSize:"16px"},children:i.icon}),i.label]},i.id))})]}),e.jsx("div",{style:{flex:"1",overflowY:"auto",padding:"24px"},children:f()})]})},D=["openai","claude","gemini"],E=({savedKeys:a,activeProvider:p,onProviderChange:l})=>{const f=o=>{switch(o){case"openai":return"OpenAI";case"claude":return"Claude";case"gemini":return"Gemini";default:return o}},i=o=>a.some(d=>d.provider===o);return e.jsx("select",{value:p,onChange:o=>l(o.target.value),style:{position:"absolute",left:"8px",bottom:"8px",padding:"4px 8px",border:"none",borderRadius:"4px",fontSize:"11px",fontFamily:"inherit",backgroundColor:"rgba(255, 255, 255, 0.9)",color:"#374151",minWidth:"80px",zIndex:1},children:D.map(o=>{const d=i(o);return e.jsx("option",{value:o,disabled:!d,style:{color:d?"#374151":"#9ca3af"},children:d?f(o):`${f(o)} (No Key)`},o)})})},M=()=>{const[a,p]=c.useState([]),[l,f]=c.useState(""),[i,o]=c.useState(!1),[d,y]=c.useState("chat"),[b,m]=c.useState([]),[x,u]=c.useState(""),v=c.useRef(null),S=c.useRef(null),w=()=>{var n;(n=v.current)==null||n.scrollIntoView({behavior:"smooth"})};c.useEffect(()=>{w()},[a]),c.useEffect(()=>{(async()=>{try{const t=await chrome.storage.local.get(["apiKeys","activeProvider"]);t.apiKeys&&(m(t.apiKeys),t.apiKeys.length>0&&!t.activeProvider?u(t.apiKeys[0].provider):t.activeProvider&&u(t.activeProvider))}catch(t){console.error("Error loading API keys:",t)}})();const r=t=>{t.apiKeys&&(m(t.apiKeys.newValue||[]),t.apiKeys.newValue&&t.apiKeys.newValue.length>0?t.apiKeys.newValue.some(h=>h.provider===x)||u(t.apiKeys.newValue[0].provider):u("")),t.activeProvider&&u(t.activeProvider.newValue||"")};return chrome.storage.onChanged.addListener(r),()=>{chrome.storage.onChanged.removeListener(r)}},[x]);const j=async n=>{if(n.preventDefault(),!l.trim()||i)return;const r={id:Date.now().toString(),role:"user",content:l.trim(),timestamp:new Date};p(s=>[...s,r]),f(""),o(!0);const t=b.find(s=>s.provider===x);if(!t){const s=g=>{switch(g){case"openai":return"OpenAI";case"claude":return"Claude";case"gemini":return"Gemini";default:return g}},h={id:(Date.now()+1).toString(),role:"assistant",content:`API key for ${s(x)} not found. Please add an API key in the settings.`,timestamp:new Date};p(g=>[...g,h]),o(!1);return}console.log("Provider:",x),console.log("API Key:",t.key);try{const s=await fetch("http://localhost:8080/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:x,prompt:r.content,apiKey:t.key})});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const h=await s.json(),g={id:(Date.now()+1).toString(),role:"assistant",content:h.content,timestamp:new Date};p(A=>[...A,g])}catch(s){console.error("Error calling AI API:",s);const h={id:(Date.now()+1).toString(),role:"assistant",content:"Error: Failed to get AI response. Please check your API key and try again.",timestamp:new Date};p(g=>[...g,h])}finally{o(!1)}},k=n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),j(n))};return e.jsxs("div",{style:{height:"100vh",display:"flex",flexDirection:"column",backgroundColor:"#ffffff",color:"#1f2937",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans", Helvetica, Arial, sans-serif',fontSize:"14px",lineHeight:"1.5"},children:[e.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid #e5e7eb",backgroundColor:"#f9fafb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx("img",{src:"icons/logo-header.png",style:{width:"24px",height:"24px"}})}),e.jsx("button",{onClick:()=>y(d==="chat"?"settings":"chat"),style:{padding:"8px",border:"none",borderRadius:"6px",backgroundColor:"transparent",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s ease"},onMouseOver:n=>n.currentTarget.style.backgroundColor="#f3f4f6",onMouseOut:n=>n.currentTarget.style.backgroundColor="transparent",children:d==="chat"?e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"#6b7280",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"3"}),e.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}):e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"#6b7280",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})})]}),d==="chat"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{flex:"1",overflowY:"auto",padding:"16px",display:"flex",flexDirection:"column",gap:"16px"},children:[a.length===0&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:"#6b7280",textAlign:"center",gap:"16px"},children:[e.jsx("div",{style:{width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx("img",{src:"icons/logo-welcome.png",style:{width:"48px",height:"48px"}})}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 4px 0",fontSize:"16px",color:"#111827"},children:"Welcome to Silq AI"}),e.jsx("p",{style:{margin:"0",fontSize:"14px"},children:"Your AI-powered writing assistant"})]})]}),a.map(n=>e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:e.jsxs("div",{style:{alignSelf:n.role==="user"?"flex-end":"flex-start",maxWidth:"85%"},children:[e.jsx("div",{style:{backgroundColor:n.role==="user"?"#7c3aed":"#f3f4f6",color:n.role==="user"?"#ffffff":"#374151",borderRadius:"12px",padding:"8px 12px",border:n.role==="user"?"none":"1px solid #e5e7eb"},children:e.jsx("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",lineHeight:"1.5",fontSize:"14px"},children:n.content})}),e.jsx("div",{style:{fontSize:"11px",color:"#9ca3af",marginTop:"4px",textAlign:n.role==="user"?"right":"left",paddingLeft:n.role==="user"?"0":"4px",paddingRight:n.role==="user"?"4px":"0"},children:n.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},n.id)),i&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:e.jsx("div",{style:{alignSelf:"flex-start",maxWidth:"85%"},children:e.jsxs("div",{style:{backgroundColor:"#f3f4f6",borderRadius:"12px",padding:"8px 12px",border:"1px solid #e5e7eb",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:"14px",height:"14px",border:"2px solid #d1d5db",borderTop:"2px solid #7c3aed",borderRadius:"50%",animation:"spin 1s linear infinite"}}),e.jsx("span",{style:{color:"#6b7280",fontSize:"14px"},children:"Thinking..."})]})})}),e.jsx("div",{ref:v})]}),e.jsx("div",{style:{padding:"16px",borderTop:"1px solid #e5e7eb",backgroundColor:"#f9fafb"},children:e.jsxs("form",{onSubmit:j,style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsxs("div",{style:{position:"relative",border:"1px solid #d1d5db",borderRadius:"8px",backgroundColor:"#ffffff",transition:"border-color 0.2s ease"},children:[e.jsx(E,{savedKeys:b,activeProvider:x,onProviderChange:u}),e.jsx("textarea",{ref:S,value:l,onChange:n=>f(n.target.value),onKeyDown:k,placeholder:"Ask me anything about your writing...",disabled:i,style:{width:"100%",minHeight:"44px",maxHeight:"120px",padding:"12px 16px",backgroundColor:"transparent",border:"none",outline:"none",color:"#374151",fontSize:"14px",lineHeight:"1.5",resize:"none",fontFamily:"inherit",boxSizing:"border-box"}}),e.jsx("button",{type:"submit",disabled:!l.trim()||i,style:{position:"absolute",right:"8px",bottom:"8px",width:"28px",height:"28px",borderRadius:"6px",border:"none",backgroundColor:l.trim()&&!i?"#7c3aed":"#f3f4f6",color:l.trim()&&!i?"white":"#9ca3af",cursor:l.trim()&&!i?"pointer":"not-allowed",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",transition:"background-color 0.2s ease"},children:"â†’"})]}),e.jsx("div",{style:{fontSize:"11px",color:"#9ca3af",textAlign:"center"},children:"Press Enter to send, Shift+Enter for new line"})]})})]}):e.jsx(R,{}),e.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `})]})},P=document.getElementById("root");P&&I(P).render(e.jsx(M,{}));
